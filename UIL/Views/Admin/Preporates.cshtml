@inject DAL.Interfaces.IPreporateRepository PreporateRepository
@inject IProviderRepository ProviderRepository
@inject IPreporateTypeRepository PreporateTypeRepository

@model UIL.Models.PreporatesSearch
@{
    ViewData["Title"] = "Препораты";
	List<Preporate> preporates = PreporateRepository.GetAll().ToList();
	List<Provider> providers = ProviderRepository.GetAll().ToList();
	List<PreporateType> types = PreporateTypeRepository.GetAll().ToList();
}

@if(User.Identity.IsAuthenticated){
	<div class="main main--aside">
		<div class="container">
			<div class="main__inner">
				<div class="aside">
					@* <form asp-action="Filtered"> *@
					@* 	<div class="aside__title">Поиск</div> *@
					@* 	<div class="aside__text">Дата</div> *@
					@* 	<input asp-for="DateDown" class="input input--small" /> *@
					@* 	<input asp-for="DateUp" class="input input--small" /> *@
					@* 	<div class="aside__text">Название</div> *@
					@* 	<input asp-for="Name" class="input input--small" /> *@
					@* 	<div class="aside__text">Поставщики</div> *@
					@* 	@foreach (var v in providers) *@
					@* 	{ *@
					@* 		<input name="Providers" value="@v" type="checkbox" @(providers.Contains(v) ? "checked" : "")/> *@
					@* 	} *@
					@* 	$1$ @for (int i = 0; i < providers.Count; i++) #1# *@
					@* 	$1$ { #1# *@
					@* 	$1$ 	<input name="Providers" value="@providers[i].Id.ToString()" type="checkbox"/> #1# *@
					@* 	$1$ } #1# *@
					@* 	$1$ <input asp-for="" class="input input--small"> #1# *@
					@* 	$1$ <div class="aside__text">Адрес поставщика</div> #1# *@
					@* 	$1$ <input asp-for="ProviderAdress" class="input input--small"> #1# *@
					@* 	<br> *@
					@* 	<br> *@
					@* 	<button type="submit" class="btn btn--big">Найти</button> *@
					@* </form> *@
				</div>
				<div class="catalog">
					<div class="catalog__items">
						@{
							Console.WriteLine(preporates==null);
							if (preporates!=null)
							{
								foreach (var item in preporates)
								{
									<div class="catalog__item">
										@if (item.Image == null)
										{
											<div class="item__img" style="background-image:url('./images/box.png');"></div>
										}
										else
										{
											@* <div class="item__img" background-image="src(@String.Concat("data:image/png;base64,",@Convert.ToBase64String(item.Image)))"></div> *@
											<div class="item__img" style="background-image: url('@Url.Action("GetImage","Home")')"></div>
										}
										<div class="item__content">
											<a asp-route-id="@item.Id.ToString()" asp-controller="Card" asp-action="Index" class="item__title">@item.Name</a>
											<div class="item__infos">
												<div class="item__info">Тип: @types.FirstOrDefault(x=>x.Id==item.PreporateTypeId).Name </div>
												<div class="item__info">Цена: @item.Cost.ToString()</div>
											</div>
										</div>
									</div>
								}
							}
							
						}

					</div>
				</div>
			</div>
		</div>
	</div>
}